<!DOCTYPE html>

<html lang="fr">


<!-- Mirrored from www.alsacreations.com/tuto/lire/1931-IA--Interroger-un-LLM-en-JavaScript-avec-Ollama.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 17 Dec 2024 16:34:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head prefix="og: https://ogp.me/ns#">
    <meta charset="UTF-8">
    <title>IA : Interroger un LLM en JavaScript avec Ollama - Alsacreations</title>

    <link rel="dns-prefetch" href="http://cdn.alsacreations.net/"><link rel="dns-prefetch" href="http://cdnf.alsacreations.net/">
    <link rel="apple-touch-icon" href="../../../cdn.alsacreations.net/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="../../../cdn.alsacreations.net/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../../../cdn.alsacreations.net/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../../cdn.alsacreations.net/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../../../cdn.alsacreations.net/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../../cdn.alsacreations.net/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../../../cdn.alsacreations.net/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../../../cdn.alsacreations.net/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../../../cdn.alsacreations.net/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../cdn.alsacreations.net/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="../../../cdn.alsacreations.net/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../../cdn.alsacreations.net/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="../../../cdn.alsacreations.net/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="../../../cdn.alsacreations.net/favicon-16x16.png" sizes="16x16">

    <link rel="manifest" href="../../manifest.json">

            <meta name="keywords" content="javascript, llm, ia">    
    <meta name="geo.placename" content="Strasbourg, Alsace, France">
    <meta name="msapplication-TileColor" content="#abc737">
    <meta name="msapplication-TileImage" content="../../../cdn.alsacreations.net/mstile-144x144.png">
    <meta name="theme-color" content="#abc737">

    <link rel="stylesheet" type="text/css" href="../../../cdn.alsacreations.net/css/dist/styles.1727690106.min.css">
    <link rel="search" type="application/opensearchdescription+xml" title="Alsacreations" href="../../opensearch.xml">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">

    <meta name="twitter:site" content="@alsacreations">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="og:locale" content="fr_FR">
    <meta name="og:site_name" content="Alsacréations">

    <meta property="twitter:creator" content="@diou"><meta property="og:title" content="IA : Interroger un LLM en JavaScript avec Ollama"><meta property="og:url" content="1931-IA--Interroger-un-LLM-en-JavaScript-avec-Ollama.html"><meta property="og:image" content="../../../cdn.alsacreations.net/xmedia/doc/full/1727764430-lama-kiwi-head.jpg"><meta property="og:type" content="article"><link href="../../../cdn.alsacreations.net/css/fonts/fontello/css/ac.1726406507.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://cdn.alsacreations.net/css/prism.min.css">
<link rel="alternate" type="application/rss+xml" href="../../rss/actualites.xml" title="Actualités">
<link rel="alternate" type="application/rss+xml" href="../../rss/commentaires.xml" title="Commentaires">
<link rel="alternate" type="application/rss+xml" href="../../rss/apprendre.xml" title="Tutoriels, articles, astuces (dernières publications)">

</head>

<body class="">

    <div id="hrtop" class="hrtop">
        <div class="arf"></div>
    </div>

    <header>
        <div class="site-header" id="header">

            
                <ul class="skip-links" id="evitement">
                    <li><a href="#menu">Aller au menu</a></li>
                    <li><a href="#global">Aller au contenu</a></li>
                    <li><a href="#search-q" rel="search">Aller à la recherche</a></li>
                </ul> <!-- /evitement -->

                <div class="inside" role="banner">
                    <button class="burger noprint js-burger js-hidden" type="button" aria-label="Afficher ou masquer la navigation" aria-controls="menu" aria-expanded="false" aria-pressed="false"><span class="visuallyhidden">Afficher ou masquer la navigation</span></button>

                    <div class="site-logo"><a href="../../index.html" title="Alsacréations, apprentissage des standards web, accueil"><img id="logo" alt="Accueil - Alsacreations.com" src="https://cdn.alsacreations.net/css/img/logo-alsacreations.svg" width="157" height="36"></a></div>

                    <nav role="navigation" class="megamenu">
                        <ul id="menu" class="nav-menu">
                                                        <li class="nav-item menu-apprendre active"><a href="../../tutoriels/index.html" title="Apprendre les langages du web : HTML, CSS, JavaScript"><i aria-hidden="true" class="icon-code"></i> tutoriels</a>
                                <div class="sub-nav">
                                    <ul class="sub-nav-group">
                                        <li class="sub-nav-h">Catégories</li>
                                        <li><a href="../../actu/index.html"><i aria-hidden="true" class="icon-flash"></i>actualités</a></li>
                                        <li><a href="../liste/1-html.html" class="invert cat-html"><i aria-hidden="true" class="icon-code"></i>html</a></li>
                                        <li><a href="../liste/2-css.html" class="invert cat-css"><i aria-hidden="true" class="icon-code"></i>css</a></li>
                                        <li><a href="../liste/5-javascript.html" class="invert cat-javascript"><i aria-hidden="true" class="icon-code"></i>javascript</a></li>
                                        <li><a href="../liste/11-responsive-web-design.html" class="invert cat-responsive"><i aria-hidden="true" class="icon-code"></i>responsive</a></li>
                                        <li><a href="../liste/10-design.html" class="invert cat-design"><i aria-hidden="true" class="icon-code"></i>design</a></li>
                                        <li><a href="../liste/3-accessibilite.html" class="invert cat-accessibilité"><i aria-hidden="true" class="icon-code"></i>accessibilité</a></li>
                                        <li><a href="../liste/4-developpement.html" class="invert cat-développement"><i aria-hidden="true" class="icon-code"></i>développement</a></li>
                                        <li><a href="../liste/12-vue-nuxt.html" class="invert cat-vue-nuxt"><i aria-hidden="true" class="icon-code"></i>vue et nuxt</a></li>
                                        <li><a href="../liste/9-formats-encodage-xml.html" class="invert cat-formats"><i aria-hidden="true" class="icon-code"></i>formats</a></li>
                                        <li><a href="../liste/8-web.html" class="invert cat-web"><i aria-hidden="true" class="icon-code"></i>web</a></li>
                                    </ul>
                                    <ul class="sub-nav-group">
                                        <li class="sub-nav-h">Ressources</li>
                                        <li><a href="../top/index.html"><i aria-hidden="true" class="icon-star-filled"></i>Les plus lues</a></li>
                                        <li><a href="../../outils/index.html"><i aria-hidden="true" class="icon-wrench"></i>Outils</a></li>
                                        <li><a href="../../outils/kiwipedia/index.html"><i aria-hidden="true" class="icon-wrench"></i>Guidelines</a></li>
                                        <li><a href="../../livres/index.html"><i aria-hidden="true" class="icon-book-open"></i>Livres</a></li>
                                        <li><a href="../../quiz/index.html"><i aria-hidden="true" class="icon-beer"></i>Quiz&nbsp;!</a></li>
                                        <li><a href="../../concours/index.html"><i aria-hidden="true" class="icon-gift"></i>Concours</a></li>
                                        <li class="sub-nav-h">Par niveau</li>
                                        <li><a href="../niveau/1/index.html"><i aria-hidden="true" class="icon-bat1"></i>Débutant</a></li>
                                        <li><a href="../niveau/2/index.html"><i aria-hidden="true" class="icon-bat2"></i>Confirmé</a></li>
                                        <li><a href="../niveau/3/index.html"><i aria-hidden="true" class="icon-bat3"></i>Expert</a></li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item menu-forum "><a href="https://forum.alsacreations.com/" title="Forum de la communauté Alsacreations"><i aria-hidden="true" class="icon-chat-alt"></i> forum</a>
                                <div class="sub-nav">
                                    <ul class="sub-nav-group">
                                        <li><a href="https://forum.alsacreations.com/posting.php?action=newt"><i aria-hidden="true" class="icon-plus"></i>Nouveau sujet/question</a></li>
                                        <li><a href="https://forum.alsacreations.com/forum.php?filter=forums"><i aria-hidden="true" class="icon icon-tag"></i>Catégories</a></li>
                                        <li><a href="https://forum.alsacreations.com/forum.php?filter=newreplies"><i aria-hidden="true" class="icon icon-comment-alt2"></i>Dernières réponses</a></li>
                                                                                <li><a href="https://forum.alsacreations.com/search.php"><i aria-hidden="true" class="icon-search"></i>Recherche</a></li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item menu-emploi  "><a href="https://emploi.alsacreations.com/" title="Offres et demandes d'emploi web"><i aria-hidden="true" class="icon-vcard"></i> emploi</a>
                                <div class="sub-nav">
                                    <ul class="sub-nav-group">
                                        <li><a href="https://emploi.alsacreations.com/offres.html"><i aria-hidden="true" class="icon-search"></i>Offres d&apos;emploi</a></li>
                                        <li><a href="https://emploi.alsacreations.com/demandes.html"><i aria-hidden="true" class="icon-search"></i>Demandes d&apos;emploi</a></li>
                                        <li><a href="https://emploi.alsacreations.com/favoris.html"><i aria-hidden="true" class="icon-star"></i>Favoris</a></li>
                                    </ul>
                                    <ul class="sub-nav-group">
                                        <li><a href="https://emploi.alsacreations.com/offre.html"><i aria-hidden="true" class="icon-plus"></i>Poster une offre</a></li>
                                        <li><a href="https://emploi.alsacreations.com/demande.html"><i aria-hidden="true" class="icon-plus"></i>Poster une demande</a></li>
                                                                            </ul>
                                </div>
                            </li>
                            <li class="nav-item menu-formations"><a href="https://formations.alsacreations.fr/" title="Formations web"><i aria-hidden="true" class="icon-graduation-cap"></i> formations</a>
                                <div class="sub-nav">
                                    <ul class="sub-nav-group">
                                        <!-- <li class="sub-nav-h">Catégories</li> -->
                                        <li><a href="https://formations.alsacreations.fr/formation-initiation-html-css.html" class="invert cat-html"><i aria-hidden="true" class="icon-star-filled"></i>Initiation HTML5 et CSS3</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-html5.html" class="invert cat-html"><i aria-hidden="true" class="icon-star-filled"></i>HTML5</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-css3-bonnes-pratiques.html" class="invert cat-responsive"><i aria-hidden="true" class="icon-star-filled"></i>Bonnes pratiques CSS3</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-gridlayout.html" class="invert cat-responsive"><i aria-hidden="true" class="icon-star-filled"></i>Flexbox et Grid Layout</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-vuejs.html" class="invert cat-css"><i aria-hidden="true" class="icon-star-filled"></i>Vue.js</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-nuxt.html" class="invert cat-css"><i aria-hidden="true" class="icon-star-filled"></i>Nuxt</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-jquery-ajax.html" class="invert cat-javascript"><i aria-hidden="true" class="icon-star-filled"></i>jQuery &amp; Ajax</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-typescript.html" class="invert cat-javascript"><i aria-hidden="true" class="icon-star-filled"></i>TypeScript</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-accessibilite.html" class="invert cat-accessibilité"><i aria-hidden="true" class="icon-star-filled"></i>Accessibilité</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-performances-web.html" class="invert cat-développement"><i aria-hidden="true" class="icon-star-filled"></i>Performances web</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-integration-emails-mobiles.html" class="invert cat-formats"><i aria-hidden="true" class="icon-star-filled"></i>Intégration d'e-mails mobiles</a></li>
                                        <li><a href="https://formations.alsacreations.fr/formation-sur-mesure.html" class="invert cat-web"><i aria-hidden="true" class="icon-star-filled"></i>Formation sur-mesure</a></li>
                                                                            </ul>
                                </div>
                            </li>
                                                    </ul>
                        <ul id="ident" class="member-ident">
                            <li class="member member-register"><a class="awesome greenghost" href="../../ident/register/index.html">S'inscrire</a></li>
                            <li class="member member-login"><a class="awesome green" href="../../ident/index.html">Connexion</a></li>
                        </ul>

                    
                    </nav>

                                        </div> <!-- .inside -->
        </div> <!-- #header -->

        <!-- Sous-menu -->

        
            <div id="submenu" class="submenu  ">

                <ul class="submenu-list"><li class="item active" id="submenu-tutoriels"><span><a href="../../tutoriels/index.html">Tutoriels et astuces</a></span></li><li class="item " id="submenu-outils"><span><a href="../../outils/index.html">Outils</a></span></li><li class="item " id="submenu-livres"><span><a href="../../livres/index.html">Livres</a></span></li><li class="item " id="submenu-quiz"><span><a href="../../quiz/index.html">Quiz</a></span></li></ul>                    <form id="search" class="site-search" role="search" action="https://www.alsacreations.com/search/" method="post">
                        <div class="search-rb">
                            <label for="search-q" class="visuallyhidden">Rechercher</label>
                            <i aria-hidden="true" class="icon-search"></i>
                            <input id="search-q" class="search-q" name="q" placeholder="Tutoriel, propriété css..." value="" type="text">
                        </div>
                        <input class="search-submit awesome" value="OK" name="recherche-submit" type="submit">
                                            </form>
                
            </div>
            <!-- /submenu -->

        
    </header>

    <!-- /navigation et sous-navigation -->

    
    <div id="global" class="site-global">

        <div id="page" class="site-page">
<div class="content" role="main" itemscope itemtype="https://schema.org/Article">

  <article class="tuto article lecture hero doc-markdown ">

    <header class="article-header cat-javascript">

        <p class="article-niveau">Niveau <i aria-hidden="true" class="icon icon-bat1"></i> <span class="visuallyhidden">Niveau débutant</span></p>
      <h1 class="h-article headline" itemprop="name">IA : Interroger un LLM en JavaScript avec Ollama</h1>

      
        <div class="auteur">
        <a class="auteur-avatar" aria-hidden="true" href="https://www.alsacreations.com/profil/lire/2-Rodolphe.html"><span class="avatar " data-hovertype="member" data-hoverid="2" style="background-image:url(../../../cdnf.alsacreations.net/avatars/2-riskav.jpg)"></span></a>
        <p class="auteur-cat"><span class="doctype doctype-tuto cat-javascript ">Tutoriel</span><span class="tagtag cat-javascript invert">javascript</span>  </p>
        <div class="auteur-meta"><p class="auteur-meta-details">
        Publié 
        <span class="visuallyhidden" itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
            <meta content="https://cdn.alsacreations.net/xmedia/doc/medium/1727764430-lama-kiwi-head.jpg" itemprop="url">
        </span>par <a href="https://www.alsacreations.com/profil/lire/2-Rodolphe.html"><span itemprop="author">Rodolphe</span></a> le <time datetime="2024-10-02" itemprop="datePublished">02 Octobre 2024</time>, mis &agrave; jour le <time datetime="2024-10-03" itemprop="dateModified">03 Octobre 2024</time> (2579 lectures)</p>
        <p class="auteur-tag"><i aria-hidden="true" class="icon-tag" title="Étiquettes"></i> <span itemprop="keywords" class="keywords"><a href="https://www.alsacreations.com/search/tag/javascript">javascript</a> <a href="https://www.alsacreations.com/search/tag/llm">llm</a> <a href="https://www.alsacreations.com/search/tag/ia">ia</a></p></div>
        
            <div itemprop="interactionStatistic" itemscope itemtype="https://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="https://schema.org/ReadAction">
              <meta itemprop="userInteractionCount" content="2579">
            </div>
        </div>
    </header>

    
  <div class="doc-content" itemprop="articleBody">
  <p>Nous n'avons pas fini d'entendre parler de les LLM (grands modèles de langages) et de l'Intelligence Artificielle. Outre les sytèmes en ligne (souvent payants) il est possible d'interroger un modèle local (gratuitement) par l'intermédiaire d'un peu de JavaScript.</p>

<p>Pour ceci nous utiliserons :</p>

<p><img src="https://www.alsacreations.com/xmedia/doc/original/1727733655-ollama-web.png" alt="Ollama" title="" data-img_id="3493"></p>

<ul>
<li><a href="https://ollama.com/">Ollama</a> qui permet de télécharger <a href="https://ollama.com/models">des modèles</a> au choix</li>
<li>Un des modèles proposés, par exemple <em>llama</em> de Meta</li>
<li>La <a href="https://www.npmjs.com/package/ollama">bibliothèque JavaScript Ollama</a> (package npm)</li>
</ul>

<h2>Ollama</h2>

<p><a href="https://ollama.com/">Ollama</a> est une application disponible pour Linux, macOS, Windows qui sert d'interface de gestion de LLM. Voyons la comme une sorte de Docker qui ira piocher dans un catalogue d'images disponibles en ligne, faciles à télécharger et à exécuter en une seule instruction ou presque en précisant bien le nom du modèle souhaité.</p>

<p>Les commandes essentielles après avoir téléchargé et installé Ollama :</p>

<ul>
<li><code>ollama list</code> liste les modèles déjà téléchargés</li>
<li><code>ollama pull &lt;modèle&gt;</code> télécharge un nouveau LLM</li>
<li><code>ollama run &lt;modèle&gt;</code> exécute</li>
<li><code>ollama stop &lt;modèle&gt;</code> met fin à l'exécution</li>
<li><code>ollama rm &lt;modèle&gt;</code> supprime</li>
</ul>

<p>Pour l'occasion, nous utiliserons llama 3.2</p>

<pre><code class="language-sh">ollama pull llama3.2
</code></pre>

<p>Pour préciser une autre version du modèle avec nombre de paramètres (comprenez complexité et poids) différent, on pourra par exemple indiquer <code>ollama pull llama3.2:1b</code> pour <em>1B</em> soit un milliard de paramètres.</p>

<p>Jusque-là si tout va bien, nous pouvons d'ores et déjà discuter en mode texte brut par un <code>ollama run llama3.2</code>.</p>

<h2>Package JavaScript Ollama</h2>

<p>Cette bibliothèque nous permet d'aller interroger Ollama installé localement en définissant le modèle, le message à lui envoyer et en traitant la réponse. De manière très basique on peut se servir de console.log mais ce n'est pas très intéressant car bloquant jusqu'à obtenir la totalité de la réponse ; la promptitude du modèle dépendra aussi de la puissance de votre machine et de votre mémoire vive disponible.</p>

<p>À l'aide d'un environnement Node.js (déjà installé n'est-ce pas ?), nous pouvons poursuivre.</p>

<ol>
<li><p>Créer un dossier quelconque 📁 pour notre projet.</p></li>
<li><p>Installer la dépendnace avec <code>npm install --save ollama</code> (ou avec <a href="https://www.alsacreations.com/article/lire/1907-Les-gestionnaires-de-paquets-pour-Node--npm-yarn-pnpm.html">pnpm</a>)</p></li>
</ol>

<p><img src="https://www.alsacreations.com/xmedia/doc/original/1727729563-npm-install-ollama.png" alt="npm install ollama" title="" data-img_id="3490"></p>

<ol start="3">
<li>Écrire un petit script <code>kiwi.mjs</code> pour importer <code>ollama</code> et appeler <code>chat()</code> afin de lancer la discussion</li>
</ol>

<pre><code class="language-js">import ollama from 'ollama'

const response = await ollama.chat({
  model: 'llama3.2',
  messages: [{ role: 'user', content: 'Quelle est la recette du cake au kiwi ?' }],
})
// ⚠️ Ceci peut prendre beaucoup de temps car on attend la réponse complète
console.log(response.message.content)
</code></pre>

<p>Il suffira de l'exécuter en ligne de commande avec <code>node kiwi.mjs</code>.</p>

<p><img src="https://www.alsacreations.com/xmedia/doc/original/1727729579-node-ollama.png" alt="Exécution d'ollama dans le terminal" title="" data-img_id="3491"></p>

<p>Pour <em>streamer</em> la réponse, c'est-à-dire la restituer au fur et à mesure de l'ajout de mots par le LLM, on peut se servir de l'alternative en activant l'option <em>stream</em>.</p>

<pre><code class="language-js">import ollama from 'ollama'

const message = { role: 'user', content: 'Quelle est la recette du cake au kiwi ?' }
const response = await ollama.chat({ model: 'llama3.2', messages: [message], stream: true })
for await (const part of response) {
  process.stdout.write(part.message.content)
}
</code></pre>

<p>Un bon nombre d'autres paramètres et méthodes existent dans cette interface, il suffira de consulter la <a href="https://www.npmjs.com/package/ollama">documentation</a> pour les découvrir.</p>

<h2>Et en application web ?</h2>

<p>C'est possible ! Une page interrogera le modèle via ollama :</p>

<p><img src="https://www.alsacreations.com/xmedia/doc/original/1727733164-oolama-js.png" alt="Architecture d'application web utilisant l'IA" title="" data-img_id="3492"></p>

<p>Pour transformer le tout en une petite application web utilisable dans le navigateur...</p>

<ol>
<li>Nous ajoutons <code>express</code></li>
</ol>

<pre><code class="language-sh">npm install --save express
</code></pre>

<p>Ce qui va permettre de construire un couple client/serveur minimaliste avec deux fichiers :</p>

<ul>
<li>server.mjs, qui sera à l'écoute des messages</li>
<li>public/index.html, qui contiendra un formulaire et affichera le résultat</li>
</ul>

<p>Les explications sont fournies par des commentaires dans le code source suivant, à vous de jouer en vous l'appropriant.</p>

<ol start="2">
<li>Fichier <code>server.mjs</code></li>
</ol>

<pre><code class="language-js">import express from 'express';
import ollama from 'ollama';

const app = express(); // Instance d'Express
const port = 3000; // Port à l'écoute

app.use(express.json());

// On sert le dossier public en statique, dans lequel on place notre page index.html
app.use(express.static('public'));

// On accepte les requêtes POST vers /chat
app.post('/chat', async (req, res) =&gt; {
  // Notre message sera envoyé dans le corps de la requête (body)
  const message = { role: 'user', content: req.body.content };

  // La réponse provenant du LLM est une promesse
  const response = await ollama.chat({ model: 'llama3.2', messages: [message], stream: true });

  // La réponse envoyée à la page web dispose d'en-têtes HTTP
  // ... permettant de faire persister la connexion
  res.writeHead(200, {
    'Content-Type': 'text/event-stream',
    'Cache-Control': 'no-cache',
    'Connection': 'keep-alive'
  });

  // Pour toute portion de réponse reçue, on la stream
  for await (const part of response) {
    res.write(`data: ${JSON.stringify(part.message)}\n\n`);
  }

  res.end();
});

// On écoute sur le port configuré
app.listen(port, () =&gt; {
  console.log(`Serveur en écoute : http://localhost:${port}`);
});
</code></pre>

<ol start="3">
<li>Page <code>public/index.html</code> correspondante :</li>
</ol>

<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html lang="fr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;KiwIA&lt;/title&gt;
    &lt;style&gt;
    /* à personnaliser selon vos envies */
    body { font-family: system-ui; background: #222; color: #fff; padding: 2rem; }
    #chat, [type=submit] { padding: 1rem; border-radius: 0.5rem; border: 1px solid #ccc; margin: 1rem 0; background: inherit; color: inherit; }
    #chat { min-width: 20rem; font-size: inherit; }
    #reponse { text-align: left; line-height: 2; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Chat KiwIA 🥝&lt;/h1&gt;

&lt;form&gt;
    &lt;input type="text" id="chat" placeholder="Votre message..."&gt;
    &lt;button type="submit"&gt;Envoyer&lt;/button&gt;
&lt;/form&gt;
&lt;div id="reponse"&gt;&lt;/div&gt;

&lt;script&gt;
    const form = document.querySelector('form');
    const input = document.querySelector('#chat');
    const resultat = document.querySelector('#reponse');

    // À la validation du formulaire
    form.addEventListener('submit', async (e) =&gt; {
        e.preventDefault();

        // On récupère le contenu du message
        const content = input.value.trim();
        if (!content) return; // Si c'est vide on arrête là

        // Petit message d'attente
        resultat.textContent = 'Un instant et je suis à vous...';
        // On vide le champ d'entrée
        input.value = '';

        try {
            // Requête asynchrone en POST vers /chat
            const response = await fetch('/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                // Corps de la requête en JSON
                body: JSON.stringify({ content }),
            });

            resultat.textContent = '';

            // On instancie une interface ReadableStream
            const reader = response.body.getReader();
            const decoder = new TextDecoder();

            // Tant qu'on a du contenu...
            while (true) {
                const { done, value } = await reader.read(); // On lit
                if (done) break;

                const lines = decoder.decode(value).split('\n');

                // On itère sur la réponse reçue pour alimenter le résultat
                for (const line of lines) {
                    if (line.startsWith('data: ')) {
                        const data = JSON.parse(line.slice(6));
                        resultat.textContent += data.content;
                    }
                }
            }
        } catch (error) {
            console.error('Error:', error);
            resultat.textContent = 'Une erreur est survenue.';
        }
    });
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<ol start="4">
<li>On lance le tout grâce à <code>node server.mjs</code> et on consulte l'adresse indiquée dans le navigateur pour atteindre la page HTML qui affiche le formulaire.</li>
</ol>

<p style="text-align: center"><video src="https://www.alsacreations.com/xmedia/tuto/movies/ollama-kiwia.mp4" loop autoplay controls muted></p>

<p>On peut perfectionner le rendu en mettant en page le message renvoyé sous forme de markdown (mais cela dépend du modèle interrogé) plutôt que de l'afficher en texte brut.</p>

<h2>Perspectives</h2>

<p>On peut voir que construire une application web sollicitant un LLM est tout à fait envisageable avec les technologies d'aujourd'hui et les standards déjà en place (HTML/CSS, JavaScript, fetch, <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream">Streams API</a>, etc). À partir de là tout est possible pour imaginer élaborer des interfaces qui vont dialoguer en texte clair ou par d'autres moyens plus subtiles, et réagir en conséquence. Vous pouvez aussi <em>briefer</em> votre LLM en amont et lui donner des instructions ou un contexte de réponse, voire en construire un nouveau (avec l'instruction <a href="https://github.com/ollama/ollama/blob/main/docs/modelfile.md">FROM de Ollama</a>).</p>

<p>Pour pousser l'horizon encore plus loin, faire tourner des LLM dans le navigateur lui-même est possible grâce à WebGPU (voir une démo ici : <a href="https://huggingface.co/spaces/cfahlgren1/Qwen-2.5-WebLLM">Qwen-2.5 on WebGPU sur Huggingface</a>) avec une performance tout à fait honorable.</p>

<p>Les concepteurs de navigateurs préparent des interfaces aisées d'accès en JavaScript pour interroger un modèle local, tels que Google avec <a href="https://developer.chrome.com/docs/ai/built-in?hl=fr">l'IA Gemini intégrée dans Chrome</a>. Nous n'avons pas fini d'en entendre parler.</p>
  </div><!-- .doc-content -->

</article>

<div class="pagination"><span class="visuallyhidden">Pages :</span></div>

  <div class="related-quiz"><h3><i aria-hidden="true" class="icon-beer"></i> Quiz</h3><p>Testez vos connaissances avec un <a href="https://www.alsacreations.com/quiz/tag/javascript">Quiz JavaScript</a></p></div><div class="commentaires-posting" id="commentaires-posting"><h2 class="posting">Commenter</h2>
  <p class="warn">Vous devez être inscrit et identifié pour utiliser cette fonction.</p>

  <h3>Connectez-vous (déjà inscrit)</h3>
  <form class="form" method="post" action="https://www.alsacreations.com/ident/login/">

    <p class="form-item">
      <label for="identname">Identifiant (pseudo) ou e-mail&nbsp;:</label> <input class="form-text" id="identname" type="text" name="name" >
    </p>

    <p class="form-item">
      <label for="identpassword">Mot de passe&nbsp;:</label> <input class="form-text" id="identpassword" type="password" name="password" />
    </p>

    <p><a href="https://www.alsacreations.com/ident/lost/" id="login-lost-link">Oubli de mot de passe&nbsp;? Pas de panique, on va le retrouver</a></p>
    <p>
      <input class="awesome green large" type="submit" value="Valider">
      <input type="hidden" name="redirect" value="">
    </p>

  </form>

  <h3><a href="https://www.alsacreations.com/ident/register">Pas encore inscrit ?</a> C'est très simple et gratuit.</h3>

</div> <!-- commentaires-posting -->
</div> <!-- .content -->

  </div> <!-- #page -->

  <p id="citation" class="citation">
    <q>&nbsp;Les promesses n'engagent que ceux qui les résolvent.&nbsp;</q> <span>(Brendan Eich)</span>  </p>

  </div><!-- #global -->

  <footer id="footer-menu" class="site-footer-menu">
    <ul>
      <li><a rel="noopener external" href="https://github.com/alsacreations/" title="Alsacreations sur Github"><i aria-hidden="true" class="icon-github-circled"></i></a></li>
      <li><a rel="noopener external" href="https://www.facebook.com/alsacreations" title="Alsacreations sur Facebook" class="f-fb"><i aria-hidden="true" class="icon-facebook"></i></a></li>
      <li><a rel="noopener external" href="https://twitter.com/alsacreations" title="Alsacreations sur Twitter"><i aria-hidden="true" class="icon-twitter"></i></a></li>
      <li><a rel="noopener external" href="https://www.instagram.com/agence_alsacreations/" title="Alsacreations sur Instagram"><i aria-hidden="true" class="icon-instagram"></i></a></li>
      <li><a rel="noopener external" href="https://fr.linkedin.com/company/alsacreations" title="Alsacreations sur LinkedIn"><i aria-hidden="true" class="icon-linkedin"></i></a></li>
      <li><a href="../../rss/index.html" title="Flux RSS" class="f-rss"><i aria-hidden="true" class="icon-rss"></i></a></li>
      <li><a href="../../page/plan/index.html">plan du site</a></li>
      <li><a href="../../contact/index.html" title="Contactez-nous">contact</a></li>
      <li><a rel="noopener" href="https://formations.alsacreations.fr/" title="Formations web professionnelles">formations</a></li>
      <li><a rel="noopener" href="https://www.alsacreations.fr/" title="Agence web de qualité">agence web</a></li>
      <li class="gopagetop"><a href="#header" title="Haut de page"><span class="visuallyhidden">Retourner en haut de page</span><i aria-hidden="true" class="icon-up"></i></a></li>
    </ul>
  </footer>

  <!-- Footer-end : logo, presentation -->
  <div id="footer-end" class="site-footer-end">
    <div class="presentation">
      <p>Alsacréations est une communauté dédiée à la conception de sites et applications web de qualité, grâce aux standards W3C, aux feuilles de styles CSS, aux langages HTML et JavaScript, et à l'accessibilité. Réalisé par l'agence web <a href="https://www.alsacreations.fr/" title="Une agence web qu'elle est bien !">Alsacreations.fr</a> &middot; Hébergement <a href="https://syazen.com/" title="Notre hébergeur ultime" rel="noopener">Syazen</a> &middot; <a href="../../page/about/index.html" title="&Agrave; propos">&Agrave;&nbsp;propos et mentions légales</a> &middot; <a href="../../page/about/index.html#l_donnees">Données personnelles</a></p>
    </div>
    <div class="print"><p>https://www.alsacreations.com/</p></div>
  </div> <!-- fin de footer-end -->

<script src="../../../cdn.alsacreations.net/js/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../../cdn.alsacreations.net/js/www/dist/www.min-ca087cd9206b8997b4cf715561d78891.js" integrity="sha256-OA7DXyLwH7s1H7qA0Z+4agjfR1PALIraEK+OQ/luP+8=" crossorigin="anonymous" defer></script>
<script src="../../../cdn.alsacreations.net/js/common/dist/common.min-aceff6d834c2060ff98f8e2b851b4e61.js" integrity="sha256-117OZrRjOLODYKQGOn589pK3+7mTs3VR0lZCgFbzADY=" crossorigin="anonymous" defer></script>
<script src="https://cdn.alsacreations.net/js/prism.min.js" integrity="sha384-pkJlJn4+ZjIgcecg/wB7Uwq5A/h6cNVWmZX0u1x24GYOSxmWf/H0NsixnQgE6rG+" crossorigin="anonymous" defer></script>
</body>

<!-- Mirrored from www.alsacreations.com/tuto/lire/1931-IA--Interroger-un-LLM-en-JavaScript-avec-Ollama.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 17 Dec 2024 16:34:49 GMT -->
</html>

<!--
CPU : 0.0026s
MEM : 0.71MB
-->
